<div align="center">

# Vision Analysis Agent (VAA)

<p align="center">
  <img src="https://img.shields.io/badge/Python-3.10+-blue.svg" alt="Python">
  <img src="https://img.shields.io/badge/FastAPI-0.128+-green.svg" alt="FastAPI">
  <img src="https://img.shields.io/badge/LangGraph-1.0+-orange.svg" alt="LangGraph">
  <img src="https://img.shields.io/badge/WeChat-MiniProgram-brightgreen.svg" alt="WeChat MiniProgram">
</p>

åŸºäºå¤šæ™ºèƒ½ä½“æ¶æ„çš„ **æ‹ç…§è†³é£Ÿåˆ†æç³»ç»Ÿ**ï¼Œç”¨æˆ·é€šè¿‡å¾®ä¿¡å°ç¨‹åºæ‹æ‘„é£Ÿç‰©ç…§ç‰‡ï¼Œç³»ç»Ÿå°†è‡ªåŠ¨è¯†åˆ«é£Ÿç‰©æˆåˆ†å¹¶è¿›è¡Œè¯¦ç»†çš„è¥å…»å¥åº·åˆ†æã€‚

</div>

## âœ¨ åŠŸèƒ½ç‰¹æ€§

| ç‰¹æ€§ | è¯´æ˜ |
|------|------|
| ğŸœ é£Ÿç‰©è¯†åˆ« | åŸºäºé€šä¹‰åƒé—®è§†è§‰å¤§æ¨¡å‹ï¼Œç²¾å‡†è¯†åˆ«å›¾ç‰‡ä¸­çš„èœå“å’Œé£Ÿæ |
| ğŸ“Š è¥å…»åˆ†æ | è‡ªåŠ¨è®¡ç®—çƒ­é‡ã€è›‹ç™½è´¨ã€è„‚è‚ªã€ç¢³æ°´ç­‰è¥å…»æˆåˆ† |
| ğŸ” æ™ºèƒ½æœç´¢ | é›†æˆ Tavily æœç´¢ï¼Œè·å–æ›´å‡†ç¡®çš„è¥å…»æ•°æ® |
| ğŸ‘¤ ç”¨æˆ·ç®¡ç† | è®°å½•ç”¨æˆ·å†å²åˆ†æï¼Œæ”¯æŒä¸ªæ€§åŒ–æ¨è |
| ğŸ“± å°ç¨‹åºç«¯ | å¾®ä¿¡å°ç¨‹åºå‰ç«¯ï¼Œä¾¿æ·æ‹ç…§ä¸Šä¼  |
| âš¡ å¿«é€Ÿå“åº” | FastAPI åç«¯ï¼Œé«˜å¹¶å‘æ”¯æŒ |

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    WeChat MiniProgram                        â”‚
â”‚                    (å¾®ä¿¡å°ç¨‹åºå‰ç«¯)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚ HTTP POST /analyze
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FastAPI Backend                           â”‚
â”‚                    (åç«¯ API æœåŠ¡)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              LangGraph Multi-Agent System                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚  Vision Agent   â”‚ â”€â”€â”€â–¶ â”‚  Analysis Agent     â”‚           â”‚
â”‚  â”‚  (å›¾åƒè¯†åˆ«)      â”‚      â”‚  (è¥å…»åˆ†æ+æœç´¢)     â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ æŠ€æœ¯æ ˆ

### åç«¯
- **æ¡†æ¶**: FastAPI + Uvicorn
- **AI æ¡†æ¶**: LangChain + LangGraph
- **å¤§æ¨¡å‹**: é€šä¹‰åƒé—® (DashScope)
- **å‘é‡æ•°æ®åº“**: FAISS / ChromaDB
- **æœç´¢**: Tavily Search

### å‰ç«¯
- **å¹³å°**: å¾®ä¿¡å°ç¨‹åº
- **è¯­è¨€**: JavaScript / WXML / WXSS

## ğŸ“¦ å®‰è£…ä¸éƒ¨ç½²

### ç¯å¢ƒè¦æ±‚

- Python >= 3.10
- å¾®ä¿¡å¼€å‘è€…å·¥å…· (ç”¨äºå‰ç«¯å¼€å‘)

### åç«¯éƒ¨ç½²

```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/yourusername/Vision_Analysis_agent.git
cd Vision_Analysis_agent

# 2. å®‰è£…ä¾èµ–
pip install -r requirements.txt

# 3. é…ç½®ç¯å¢ƒå˜é‡
# åœ¨ backend ç›®å½•ä¸‹åˆ›å»º .env æ–‡ä»¶ï¼Œå¡«å…¥:
# DASHSCOPE_API_KEY=your_dashscope_api_key
# TAVILY_API_KEY=your_tavily_api_key

# 4. å¯åŠ¨æœåŠ¡
cd backend
uvicorn app.api.main:app --host 0.0.0.0 --port 8000 --reload
```

### å‰ç«¯é…ç½®

1. ä½¿ç”¨å¾®ä¿¡å¼€å‘è€…å·¥å…·æ‰“å¼€ `frontend/miniprogram` ç›®å½•
2. ä¿®æ”¹ `utils/api.js` ä¸­çš„ API åœ°å€ä¸ºä½ çš„åç«¯æœåŠ¡åœ°å€
3. ç¼–è¯‘è¿è¡Œ

## ğŸ“¡ API æ¥å£

### POST /analyze

è†³é£Ÿåˆ†æä¸»æ¥å£

**è¯·æ±‚å‚æ•°:**
| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| username | string | æ˜¯ | ç”¨æˆ·å |
| image | file | æ˜¯ | é£Ÿç‰©å›¾ç‰‡æ–‡ä»¶ |

**å“åº”ç¤ºä¾‹:**
```json
{
  "status": "success",
  "data": {
    "dishes": ["é¥ºå­"],
    "nutrition": {
      "calories": "çº¦500kcal/100g",
      "protein": "12g/100g",
      "fat": "15g/100g",
      "carbohydrate": "28g/100g",
      "sodium": "çº¦350mg/100g"
    },
    "health_advice": "é¥ºå­è¥å…»å‡è¡¡ï¼Œå»ºè®®æ­é…è”¬èœé£Ÿç”¨..."
  }
}
```

## ğŸ§  æ™ºèƒ½ä½“è¯´æ˜

### Vision Agent (è§†è§‰æ™ºèƒ½ä½“)

è´Ÿè´£å›¾åƒè¯†åˆ«ï¼Œä½¿ç”¨é€šä¹‰åƒé—®çš„å¤šæ¨¡æ€æ¨¡å‹åˆ†æå›¾ç‰‡å†…å®¹ï¼š

- æ ¡éªŒå›¾ç‰‡æ˜¯å¦åŒ…å«é£Ÿç‰©
- è¯†åˆ«èœå“åç§°å’Œä¸»è¦é£Ÿæ
- ç”Ÿæˆé£Ÿæè¯¦ç»†æŠ¥å‘Š

```python
class VisionAgent:
    def analyze_image(self, image_path: str) -> VisionResponse:
        # è¿”å›ç»“æ„åŒ–çš„è§†è§‰åˆ†æç»“æœ
```

### Analysis Agent (åˆ†ææ™ºèƒ½ä½“)

åŸºäºè§†è§‰æŠ¥å‘Šè¿›è¡Œæ·±åº¦è¥å…»åˆ†æï¼š

- ä½¿ç”¨ LLM æå–è¥å…»ä¿¡æ¯
- è°ƒç”¨ Tavily æœç´¢è¡¥å……æ•°æ®
- ç”Ÿæˆå¥åº·å»ºè®®å¹¶å­˜å…¥ç”¨æˆ·æ•°æ®åº“

```python
class AnalysisAgent:
    def analyze(self, username: str, vision_report: str) -> dict:
        # è¿”å›å®Œæ•´çš„è¥å…»åˆ†æç»“æœ
```

### å·¥ä½œæµç¨‹

```
ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ â†’ Vision Agent è¯†åˆ« â†’ æœ‰æ•ˆæ€§åˆ¤æ–­
                                       â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ æœ‰æ•ˆ                                 â”‚ æ— æ•ˆ
                    â–¼                                      â–¼
            Analysis Agent åˆ†æ                        è¿”å›é”™è¯¯ä¿¡æ¯
                    â”‚
                    â–¼
            å­˜å‚¨ç»“æœå¹¶è¿”å›ç»™ç”¨æˆ·
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
Vision_Analysis_agent/
â”œâ”€â”€ backend/                      # Python åç«¯
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”‚   â””â”€â”€ main.py          # FastAPI ä¸»å…¥å£
â”‚   â”‚   â”œâ”€â”€ agents/
â”‚   â”‚   â”‚   â”œâ”€â”€ main_agent.py    # ä¸»æ§ Agent
â”‚   â”‚   â”‚   â”œâ”€â”€ vision_agent.py  # è§†è§‰åˆ†æ Agent
â”‚   â”‚   â”‚   â””â”€â”€ analysis_agent.py# è¥å…»åˆ†æ Agent
â”‚   â”‚   â””â”€â”€ agent_utils/         # å·¥å…·å‡½æ•°
â”‚   â”‚       â”œâ”€â”€ agent_prompt.py  # ç³»ç»Ÿæç¤ºè¯
â”‚   â”‚       â”œâ”€â”€ get_llm.py       # LLM åˆå§‹åŒ–
â”‚   â”‚       â”œâ”€â”€ process_pic.py   # å›¾ç‰‡å¤„ç†
â”‚   â”‚       â””â”€â”€ database_utils/  # æ•°æ®åº“æ“ä½œ
â”‚   â””â”€â”€ uploads/                 # ä¸Šä¼ æ–‡ä»¶ä¸´æ—¶ç›®å½•
â”œâ”€â”€ frontend/
â”‚   â””â”€â”€ miniprogram/             # å¾®ä¿¡å°ç¨‹åºä»£ç 
â”œâ”€â”€ requirements.txt             # Python ä¾èµ–
â””â”€â”€ README.md
```

## ğŸ” ç¯å¢ƒå˜é‡

éœ€è¦åœ¨ `backend/.env` æ–‡ä»¶ä¸­é…ç½®ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

```env
# é˜¿é‡Œäº‘ DashScope API Key (é€šä¹‰åƒé—®)
DASHSCOPE_API_KEY=sk-xxxxxx

# Tavily æœç´¢ API Key
TAVILY_API_KEY=tvly-xxxxxx

# å¯é€‰ï¼šå…¶ä»–é…ç½®
DEBUG=True
```

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ™ è‡´è°¢

- [LangChain](https://github.com/langchain-ai/langchain) - LLM åº”ç”¨å¼€å‘æ¡†æ¶
- [LangGraph](https://github.com/langchain-ai/langgraph) - å¤šæ™ºèƒ½ä½“ç¼–æ’
- [DashScope](https://help.aliyun.com/zh/dashscope) - é˜¿é‡Œäº‘é€šä¹‰åƒé—®
- [Tavily](https://tavily.com/) - AI æœç´¢ API

---

<div align="center">
  <sub>Built with â¤ï¸ by the VAA Team</sub>
</div>
